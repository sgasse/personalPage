[uwsgi]
master = true
enable-threads = true
vacuum = true                  ; Delete sockets during shutdown
single-interpreter = true
die-on-term = true             ; Shutdown when receiving SIGTERM
need-app = true

harakiri = 60                  ; Forcefully kill workers after 60s

max-requests = 1000            ; After how many requests to restart workers
max-worker-lifetime = 3600     ; Restart workers after 3600s
reload-on-rss = 2048           ; Restart workers after that amount of residual memory
worker-reload-mercy = 60       ; Waiting time before forcefully killing workers

socket = :3947
pythonpath = /www/app
plugins = python3
chdir = /www/app
wsgi-file = app/run.py
callable = app
processes = 4
threads = 2
stats = :9191
